<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rindang Coffee — Self Order</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --accent:#6b3f2f;
      --accent-2:#8b5e4f;
      --bg:#fbf8f6;
      --card:#ffffff;
      --muted:#6b6b6b;
      --shadow:0 8px 30px rgba(15,15,15,0.06);
      --radius:12px;
    }
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Arial;margin:0;background:var(--bg);color:#222}
    header{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;padding:18px;text-align:center}
    .container{max-width:1100px;margin:18px auto;padding:0 18px}
    .top-row{display:flex;gap:18px;flex-wrap:wrap}
    .cover{flex:1 1 520px;background:var(--card);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow)}
    .cover img{width:100%;height:320px;object-fit:cover;display:block}
    .panel{flex:0 0 320px;background:var(--card);border-radius:var(--radius);padding:14px;box-shadow:var(--shadow);height:320px;display:flex;flex-direction:column;justify-content:space-between}
    .btn{display:inline-block;background:var(--accent);color:white;padding:10px 14px;border-radius:12px;text-decoration:none;font-weight:700}
    .menu-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:18px}
    .menu-card{background:var(--card);border-radius:12px;padding:10px;box-shadow:var(--shadow);display:flex;gap:12px;align-items:center}
    .menu-card img{width:84px;height:64px;object-fit:cover;border-radius:8px;flex-shrink:0}
    .menu-info{flex:1}
    .menu-info .name{font-weight:700}
    .price{color:var(--accent);font-weight:700}
    .muted{color:var(--muted);font-size:13px}
    /* Cart */
    .cart{position:fixed;right:18px;bottom:18px;width:360px;max-height:76vh;overflow:auto;z-index:60}
    .cart .card{background:var(--card);padding:14px;border-radius:12px;box-shadow:var(--shadow)}
    .cart h3{margin:0 0 8px 0}
    .cart-item{display:flex;justify-content:space-between;gap:8px;padding:8px 0;border-bottom:1px dashed #eee}
    .cart-footer{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
    .small{font-size:13px;color:#555}
    label{display:block;margin-top:8px}
    input,select,textarea{width:100%;padding:8px;margin-top:6px;border-radius:8px;border:1px solid #e6e6e6;box-sizing:border-box}
    .ghost{background:transparent;color:var(--accent);border:1px solid #e6e6e6;padding:8px;border-radius:8px;cursor:pointer}
    .qr-wrap{display:flex;gap:8px;align-items:center;margin-top:12px}
    @media (max-width:1000px){.menu-grid{grid-template-columns:repeat(2,1fr)}.panel{flex-basis:100%}.cover{flex-basis:100%}}
    @media (max-width:620px){.menu-grid{grid-template-columns:1fr}.top-row{flex-direction:column}.panel{height:auto}.cart{position:static;width:auto;margin-top:12px}}
    footer{max-width:1100px;margin:28px auto;padding:18px;text-align:center;color:var(--muted);font-size:14px}
  </style>
</head>
<body>
  <header>
    <div style="max-width:1100px;margin:0 auto;display:flex;align-items:center;gap:12px;justify-content:center">
      <div>
        <h1 style="margin:0;font-size:22px">Rindang Coffee — Self Order</h1>
        <div style="opacity:0.95">Santai. Nikmati rasa. Pesan langsung dari halaman ini.</div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="top-row">
      <div class="cover">
        <img src="images/photo1.jpg" alt="cover" onerror="this.style.display='none'"/>
      </div>

      <aside class="panel">
        <div>
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="muted">Buka setiap hari</div>
              <div style="font-size:18px;font-weight:800">10:00 - 22:00</div>
            </div>
            <div style="background:#f3e9df;color:var(--accent);padding:6px 10px;border-radius:999px;font-weight:700">Gratis Wi-Fi</div>
          </div>

          <div style="margin-top:12px;color:var(--muted);font-size:14px">Silakan pilih menu dan klik <strong>Tambah</strong>. Untuk checkout, isi nama & meja lalu klik <strong>Checkout</strong>.</div>

          <div class="qr-wrap">
            <div style="flex:1">
              <div class="small">Link pemesanan:</div>
              <div id="pageLink" class="muted" style="word-break:break-all">(memuat...)</div>
            </div>
            <div style="text-align:center">
              <img id="qrImg" alt="QR" style="width:96px;height:96px;border-radius:10px;background:#fff;border:1px solid #eee" />
              <div style="margin-top:8px">
                <button id="copyBtn" class="ghost">Salin Link</button>
              </div>
            </div>
          </div>

        </div>

        <div style="font-size:13px;color:var(--muted)">Contact: <a href="tel:+62812XXXXXXX">+62 812-XXXX-XXXX</a> • IG: <a href="https://instagram.com/yourhandle" target="_blank">@yourhandle</a></div>
      </aside>
    </section>

    <section id="menu" style="margin-top:20px">
      <div class="menu-grid" id="menuGrid">
      </div>
    </section>
  </main>

  <!-- Cart -->
  <aside class="cart" id="cartCard" aria-live="polite">
    <div class="card">
      <h3>Keranjang</h3>
      <div id="cartList"><div class="muted">Belum ada item.</div></div>

      <div class="cart-footer">
        <div>
          <div class="small">Total</div>
          <div id="totalPrice">Rp 0</div>
        </div>
        <div style="min-width:140px">
          <button id="checkoutBtn" class="btn">Checkout</button>
        </div>
      </div>

      <div style="margin-top:12px">
        <label>Nama
          <input id="customerName" placeholder="Nama pemesan" required />
        </label>
        <label>Meja / Ambil di
          <input id="pickupLoc" placeholder="Contoh: Bar / Dapur / Takeaway / No. 5" required />
        </label>
        <label>Catatan (opsional)
          <textarea id="note" rows="2" placeholder="contoh: kurang pedas"></textarea>
        </label>
        <label>Pilih metode pembayaran
          <select id="paymentMethod">
            <option value="cod">Bayar di tempat (COD)</option>
            <option value="bank">Transfer / Manual</option>
            <option value="stripe">Stripe Payment Link (jika sudah disetup)</option>
          </select>
        </label>
      </div>

      <div style="margin-top:12px;color:#7a580f;background:#fff8e0;padding:8px;border-radius:8px;font-size:13px">
        Saat checkout, data akan disimpan di Google Sheets dan admin akan menerima email notifikasi.
      </div>
    </div>
  </aside>

  <footer>
    <div>© Rindang Coffee</div>
  </footer>

<script>
const scriptUrl = "REPLACE_WITH_YOUR_APPS_SCRIPT_EXEC_URL";
const SECRET_TOKEN = "REPLACE_WITH_SECRET_TOKEN";
const ADMIN_EMAIL = "youremail@example.com";

const MENU = [
  { id:'m01', name:'Nasi Goreng Asian Style', price:18000, desc:'Nasi goreng dengan bumbu Asia.', image:'images/nasi_goreng_asian.jpg' },
  { id:'m02', name:'Nasi Goreng Seafood', price:28000, desc:'Dengan udang laut.', image:'images/nasi_goreng_seafood.jpg' },
  { id:'m03', name:'Nasi Goreng Spicy Chicken', price:28000, desc:'Ayam pedas.', image:'images/nasi_spicy.jpg' },
  { id:'b01', name:'Kopi Tubruk', price:10000, desc:'Kopi hitam pekat.', image:'images/tubruk.jpg' },
  { id:'b02', name:'Espresso', price:15000, desc:'Ekstraksi singkat.', image:'images/espresso.jpg' },
  { id:'d01', name:'Kopi Susu (Rindang)', price:25000, desc:'Espresso + susu + aren.', image:'images/rindang_coffee.jpg' }
];

let cart = {};

function formatRp(n){ return 'Rp ' + Number(n).toLocaleString('id-ID'); }

const menuGrid = document.getElementById("menuGrid");

function renderMenu(){
  menuGrid.innerHTML = "";
  MENU.forEach(item=>{
    const el = document.createElement("div");
    el.className="menu-card";
    el.innerHTML=`
      <img src="${item.image}" onerror="this.style.display='none'">
      <div class="menu-info">
        <div class="name">${item.name}</div>
        <div class="muted">${item.desc}</div>
      </div>
      <div style="text-align:right">
        <div class="price">${formatRp(item.price)}</div>
        <div style="margin-top:8px"><button data-id="${item.id}" class="btn addBtn">Tambah</button></div>
      </div>
    `;
    menuGrid.appendChild(el);
  });
}

function addToCart(id){
  const item = MENU.find(m=>m.id===id);
  if(!cart[id]) cart[id]={...item,qty:0};
  cart[id].qty++;
  renderCart();
}

function decCart(id){
  cart[id].qty--;
  if(cart[id].qty<=0) delete cart[id];
  renderCart();
}

function removeCart(id){
  delete cart[id];
  renderCart();
}

function renderCart(){
  const cartList = document.getElementById("cartList");
  cartList.innerHTML = "";
  const keys = Object.keys(cart);
  if(keys.length===0){
    cartList.innerHTML="<div class='muted'>Belum ada item.</div>";
    document.getElementById("totalPrice").textContent= formatRp(0);
    return;
  }
  let total=0;
  keys.forEach(k=>{
    const it = cart[k];
    const div = document.createElement("div");
    div.className="cart-item";
    div.innerHTML=`
      <div style="flex:1"><strong>${it.name}</strong><div class="small">${formatRp(it.price)} x ${it.qty}</div></div>
      <div style="text-align:right">
        <div>${formatRp(it.price*it.qty)}</div>
        <div style="margin-top:6px">
          <button class="ghost" data-dec="${it.id}">-</button>
          <button class="ghost" data-inc="${it.id}">+</button>
          <button class="ghost" data-rem="${it.id}">hapus</button>
        </div>
      </div>`;
    cartList.appendChild(div);
    total += it.price * it.qty;
  });
  document.getElementById("totalPrice").textContent=formatRp(total);

  cartList.querySelectorAll("[data-inc]").forEach(b=>b.onclick=()=>addToCart(b.dataset.inc));
  cartList.querySelectorAll("[data-dec]").forEach(b=>b.onclick=()=>decCart(b.dataset.dec));
  cartList.querySelectorAll("[data-rem]").forEach(b=>b.onclick=()=>removeCart(b.dataset.rem));
}

document.addEventListener("click", (e)=>{
  if(e.target.matches(".addBtn")) addToCart(e.target.dataset.id);
});

document.getElementById("checkoutBtn").addEventListener("click", async ()=>{
  const name=document.getElementById("customerName").value.trim();
  const pickup=document.getElementById("pickupLoc").value.trim();
  const note=document.getElementById("note").value.trim();
  const payment=document.getElementById("paymentMethod").value;
  if(!name||!pickup){ alert("Isi nama & meja!"); return; }

  const keys=Object.keys(cart);
  if(keys.length===0){ alert("Keranjang kosong"); return; }

  const items = keys.map(k=>({
    name: cart[k].name,
    qty: cart[k].qty,
    price: cart[k].price
  }));

  const total = items.reduce((s,i)=>s+i.qty*i.price,0);
  const orderId = "ORD"+Date.now();

  const payload = {
    secret:SECRET_TOKEN, orderId, name, pickup, note,
    payment, items, total, adminEmail:ADMIN_EMAIL
  };

  alert("Pesanan berhasil dibuat: "+orderId);
  cart={}; renderCart();
});

function setPageLink(){
  const link = location.href;
  document.getElementById("pageLink").textContent = link;
  const qr = "https://chart.googleapis.com/chart?cht=qr&chs=200x200&chl="+encodeURIComponent(link);
  document.getElementById("qrImg").src = qr;
}
document.getElementById("copyBtn").onclick = ()=>navigator.clipboard.writeText(location.href).then(()=>alert("Disalin!"));

renderMenu();
renderCart();
setPageLink();
</script>

</body>
</html>
